<svg viewBox="0 0 800 650" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="800" height="650" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#2c3e50">
    Cross-Encoder Architecture for Query-Document Reranking
  </text>
  
  <!-- Input Layer -->
  <g id="input-layer">
    <!-- Query Input -->
    <rect x="50" y="80" width="120" height="40" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5"/>
    <text x="110" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#1976d2">
      Query (Q)
    </text>
    <text x="110" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">
      "machine learning"
    </text>
    
    <!-- Document Input -->
    <rect x="230" y="80" width="120" height="40" fill="#fff3e0" stroke="#f57c00" stroke-width="2" rx="5"/>
    <text x="290" y="105" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#f57c00">
      Document (D)
    </text>
    <text x="290" y="140" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">
      "AI techniques for..."
    </text>
  </g>
  
  <!-- Concatenation -->
  <g id="concatenation">
    <!-- Arrow from inputs to concat -->
    <line x1="110" y1="150" x2="200" y2="180" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    <line x1="290" y1="150" x2="200" y2="180" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- Concatenation box -->
    <rect x="140" y="180" width="120" height="40" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2" rx="5"/>
    <text x="200" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#7b1fa2">
      Concatenation
    </text>
    <text x="200" y="240" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">
      [CLS] Q [SEP] D [SEP]
    </text>
  </g>
  
  <!-- Tokenization -->
  <g id="tokenization">
    <line x1="200" y1="250" x2="200" y2="280" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <rect x="140" y="280" width="120" height="40" fill="#e8f5e8" stroke="#388e3c" stroke-width="2" rx="5"/>
    <text x="200" y="305" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#388e3c">
      Tokenization
    </text>
  </g>
  
  <!-- Transformer Encoder -->
  <g id="transformer">
    <line x1="200" y1="330" x2="200" y2="360" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <!-- Multiple transformer layers -->
    <rect x="120" y="360" width="160" height="120" fill="#fff8e1" stroke="#ff8f00" stroke-width="2" rx="5"/>
    <text x="200" y="380" text-anchor="middle" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#ff8f00">
      Transformer Encoder
    </text>
    
    <!-- Individual layers -->
    <rect x="130" y="390" width="140" height="20" fill="#ffecb3" stroke="#ff8f00" stroke-width="1" rx="3"/>
    <text x="200" y="403" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ff8f00">
      Multi-Head Attention
    </text>
    
    <rect x="130" y="415" width="140" height="20" fill="#ffecb3" stroke="#ff8f00" stroke-width="1" rx="3"/>
    <text x="200" y="428" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ff8f00">
      Feed Forward
    </text>
    
    <rect x="130" y="440" width="140" height="20" fill="#ffecb3" stroke="#ff8f00" stroke-width="1" rx="3"/>
    <text x="200" y="453" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#ff8f00">
      Layer Norm + Residual
    </text>
    
    <text x="200" y="470" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#666">
      (L layers)
    </text>
  </g>
  
  <!-- CLS Token Extraction -->
  <g id="cls-extraction">
    <line x1="200" y1="490" x2="200" y2="520" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <rect x="140" y="520" width="120" height="40" fill="#fce4ec" stroke="#c2185b" stroke-width="2" rx="5"/>
    <text x="200" y="540" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#c2185b">
      [CLS] Token
    </text>
    <text x="200" y="555" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">
      Representation
    </text>
  </g>
  
  <!-- Classification Head -->
  <g id="classification">
    <line x1="200" y1="570" x2="450" y2="520" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <rect x="390" y="500" width="120" height="40" fill="#e1f5fe" stroke="#0277bd" stroke-width="2" rx="5"/>
    <text x="450" y="520" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#0277bd">
      Classification
    </text>
    <text x="450" y="535" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">
      Head (Linear)
    </text>
  </g>
  
  <!-- Output -->
  <g id="output">
    <line x1="450" y1="550" x2="450" y2="580" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
    
    <rect x="390" y="580" width="120" height="40" fill="#e8f5e8" stroke="#2e7d32" stroke-width="2" rx="5"/>
    <text x="450" y="600" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#2e7d32">
      Relevance Score
    </text>
    <text x="450" y="615" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">
      P(relevant | Q, D)
    </text>
  </g>
  

  
  <!-- Arrow marker definition -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" 
            refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
  </defs>
  
  <!-- Data Flow Labels -->
  <text x="70" y="175" font-family="Arial, sans-serif" font-size="9" fill="#666">
    Input
  </text>
  <text x="320" y="175" font-family="Arial, sans-serif" font-size="9" fill="#666">
    Texts
  </text>
  <text x="320" y="400" font-family="Arial, sans-serif" font-size="9" fill="#666">
    Encoded
  </text>
  <text x="320" y="415" font-family="Arial, sans-serif" font-size="9" fill="#666">
    Representations
  </text>
  <text x="320" y="545" font-family="Arial, sans-serif" font-size="9" fill="#666">
    Final Score
  </text>
</svg>